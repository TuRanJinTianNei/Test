# OFDM系统仿真项目

## 项目概述

本项目是一个完整的OFDM（正交频分复用）通信系统仿真平台，实现了从发送端到接收端的完整链路，包括16QAM调制、IFFT/FFT变换、循环前缀、加窗处理、信道传输和误码率分析等功能。

## 系统架构

```
发送端 → 信道 → 接收端
  ↓       ↓       ↓
比特流   AWGN   比特流
16QAM    噪声   16QAM
IFFT            FFT
加CP            去CP
加窗            解调
```

## 核心系统参数

### 1. OFDM基本参数

| 参数名称 | 符号 | 数值 | 说明 |
|---------|------|------|------|
| **IFFT点数** | N | 512 | IFFT/FFT变换的点数（包含有效、空、镜像与DC） |
| **有效数据子载波数** | - | 200 | 承载16QAM调制数据的子载波数 |
| **共轭镜像子载波数** | - | 200 | 保证IFFT输出为实信号的共轭镜像子载波 |
| **空子载波总数** | - | 112 | 包括DC、保护带和中间空子载波 |
| **调制方式** | - | 16QAM | 每个子载波承载4比特 |
| **每子载波比特数** | bits_per_symbol | 4 | 16QAM调制阶数 |

### 2. 帧结构参数

| 参数名称 | 符号 | 数值 | 说明 |
|---------|------|------|------|
| **每帧OFDM符号数** | symbols_per_frame | 50 | 每帧包含的OFDM符号数量 |
| **总传输符号数** | total_symbols | 1000 | 仿真中总共传输的OFDM符号数 |
| **总比特数** | baseband_out_length | 800,000 | carrier_count × total_symbols × bits_per_symbol |

### 3. 保护间隔参数

| 参数名称 | 符号 | 数值 | 说明 |
|---------|------|------|------|
| **循环前缀比例** | PrefixRatio | 1/4 | GI/N，循环前缀占IFFT点数的比例 |
| **循环前缀长度** | GI | 128 | PrefixRatio × IFFT_bin_length |
| **后缀长度** | GIP | 40 | 配合加窗的尾部过渡长度（≤ GI） |
| **单个符号总长度** | - | 680 | N + GI + GIP = 512 + 128 + 40 |

### 4. 加窗参数（LTE风格）

| 参数名称 | 符号 | 数值 | 说明 |
|---------|------|------|------|
| **滚降系数** | beta | 1/16 | 加窗过渡带占比，越小过渡越短 |
| **窗函数类型** | - | 升余弦窗 | LTE标准升余弦窗函数 |
| **重叠方法** | solution_method | 3 | LTE标准方法：重叠相加 |
| **重叠区域** | - | ≤ GI | 重叠区域限制在CP内，不影响有效数据 |

**加窗原理说明：**
- 目的：抑制符号边缘的陡峭跳变，减少带外辐射（频谱泄露）
- 重叠机制：符号拼接时存在可控的重叠，重叠区域限制在循环前缀（CP）内
- 符号结构：`[CP(GI) | 主体(N) | 后缀(GIP)]`
- 重叠区域：当前符号的后缀(GIP)与下一个符号的CP前GIP个样本重叠相加

### 5. 子载波分配

#### 5.1 有效数据子载波
- **索引范围**: 29-228（共200个子载波）
- **类型**: 承载16QAM调制数据
- **计算方式**: `carriers = (1:carrier_count) + (floor(IFFT_bin_length/4) - floor(carrier_count/2))`

#### 5.2 共轭镜像子载波
- **索引范围**: 286-485（共200个子载波）
- **类型**: 数据子载波的共轭，保证IFFT输出为实信号
- **计算方式**: `conjugate_carriers = IFFT_bin_length - carriers + 2`

#### 5.3 空子载波分布（共112个）

| 索引范围 | 类型 | 数量 | 说明 |
|---------|------|------|------|
| **1** | DC子载波 | 1 | 直流分量，设为0 |
| **2-28** | 低频保护带 | 27 | 频谱左侧保护带，避免干扰 |
| **229-285** | 中间空子载波 | 57 | 数据子载波与共轭镜像之间的间隔 |
| **486-512** | 高频保护带 | 27 | 频谱右侧保护带，避免干扰 |

**验证**: 512 = 200 + 200 + 112 ✓

### 6. 信道参数

| 参数名称 | 符号 | 数值 | 说明 |
|---------|------|------|------|
| **信道类型** | - | AWGN | 加性高斯白噪声信道 |
| **目标SNR（详细分析）** | targetSNRdB | 15 dB | 用于详细分析的SNR点 |
| **SNR范围（BER曲线）** | SNR_range | 10-30 dB | BER-SNR性能曲线范围 |
| **SNR步进** | - | 2 dB | BER曲线计算步进 |

### 7. 性能指标

| 指标名称 | 说明 |
|---------|------|
| **BER（误码率）** | 比特错误率，用于评估系统性能 |
| **MSE（均方误差）** | 发送信号与接收信号的均方误差 |
| **频谱效率** | 有效数据子载波数 × bits_per_symbol / (N + GI) |

## 文件结构

### 主程序文件

| 文件名 | 功能描述 |
|--------|---------|
| `test1.m` | **主程序** - 完整OFDM系统仿真，生成13个Figure，包含BER-SNR曲线 |
| `singleSNR.m` | 单SNR点详细分析版本（与test1.m功能相同） |
| `OFDM_16QAM.m` | 另一种OFDM系统实现方式，用于对比 |

### 辅助函数文件

| 文件名 | 功能描述 |
|--------|---------|
| `qam16.m` | 16QAM调制函数 |
| `demoduqam16.m` | 16QAM解调函数（最小欧氏距离判决） |
| `rcoswindow.m` | 升余弦窗函数生成 |
| `rcoswindow_improved.m` | 改进版升余弦窗函数 |

### 测试与演示文件

| 文件名 | 功能描述 |
|--------|---------|
| `test2.m` | 瑞利信道仿真（待实现） |
| `test3.m` | Wi‑Fi (802.11n/ac) 20 MHz OFDM子载波占用演示 |
| `test4.m` | OFDM子载波正交性的连续频谱仿真演示 |
| `test5.m` | 卷积物理意义模拟：低通滤波过程 |
| `test6.m` | 二维高斯分布到瑞利分布的推导步骤 + 可视化示例 |

### 文档文件

| 文件名 | 功能描述 |
|--------|---------|
| `README.md` | 项目说明文档（本文件） |
| `空子载波位置说明.md` | 详细的空子载波位置分布说明 |

## 可视化输出（test1.m / singleSNR.m）

### Figure索引说明

#### 【一】单符号分析与可视化
- **Figure 1**: IFFT各频点幅度
- **Figure 2**: IFFT各频点相位
- **Figure 3**: 单符号时域（未加CP/后缀）
- **Figure 4**: 单符号时域（加CP与后缀）
- **Figure 5**: 单符号时域（加窗后）

#### 【二】帧级、串行信号与频谱分析
- **Figure 6**: 串行发送时域对比（上：逐符号；下：帧级+末尾后缀）
- **Figure 7**: 加窗前后局部窗口时域对比
- **Figure 8**: 加窗前后局部窗口频域对比（双边谱）

#### 【三】信道影响与接收端评估
- **Figure 12**: 局部窗口时域对比（含SNR/MSE命令行打印）
- **Figure 13**: 局部窗口双边谱对比

#### 【四】解调判决与性能
- **Figure 9**: 接收端16QAM星座图
- **Figure 10**: 比特流发/收前100位对比
- **Figure 11**: BER-SNR曲线（10-30dB，步进2dB）

## 使用方法

### 运行主程序

```matlab
% 运行完整OFDM系统仿真
test1.m

% 或运行单SNR详细分析版本
singleSNR.m
```

### 运行测试程序

```matlab
% Wi‑Fi子载波占用演示
test3.m

% OFDM子载波正交性演示
test4.m

% 卷积物理意义演示
test5.m

% 瑞利分布推导演示
test6.m
```

## 系统特点

1. **完整的OFDM链路**: 实现了从比特流到比特流的完整通信链路
2. **LTE标准加窗**: 采用LTE风格的升余弦窗，重叠区域限制在CP内
3. **详细的可视化**: 生成13个Figure全面展示系统各环节
4. **性能分析**: 包含BER-SNR曲线、星座图、频谱分析等
5. **模块化设计**: 函数模块化，便于修改和扩展

## 参数调整建议

### 修改IFFT点数
```matlab
IFFT_bin_length = 1024;  % 改为1024点
% 注意：需要相应调整carrier_count和carriers索引
```

### 修改调制方式
```matlab
bits_per_symbol = 2;  % 改为QPSK（需要修改qam16函数）
% 或
bits_per_symbol = 6;  % 改为64QAM（需要修改qam16函数）
```

### 修改循环前缀比例
```matlab
PrefixRatio = 1/8;  % 减小CP比例（提高频谱效率，但抗多径能力降低）
% 或
PrefixRatio = 1/2;  % 增大CP比例（提高抗多径能力，但降低频谱效率）
```

### 修改SNR范围
```matlab
SNR_range = 0:2:40;  % 扩展SNR范围
targetSNRdB = 20;    % 修改详细分析的SNR点
```

## 理论背景

### OFDM原理
- **正交性**: 子载波间隔 Δf = 1/T，使得各子载波在彼此中心处为零
- **循环前缀**: 将符号尾部复制到开头，对抗多径干扰
- **加窗**: 平滑符号边缘，降低频谱旁瓣

### 16QAM调制
- **星座点数**: 16个星座点
- **每符号比特数**: 4比特
- **Gray编码**: 相邻星座点仅差1比特，降低误码率

### 瑞利分布（test6.m）
- **推导**: 二维高斯分布 → 瑞利分布（幅度）
- **应用**: 无线通信中的瑞利衰落信道

## 性能指标参考值

在SNR = 15 dB条件下（典型值）：
- **BER**: 约 10⁻⁴ ~ 10⁻³（取决于具体实现）
- **频谱效率**: 约 1.56 bit/s/Hz（200 × 4 / (512 + 128)）

## 注意事项

1. **随机种子**: 程序使用固定随机种子（`rand('twister',0)`）以保证可重复性
2. **内存占用**: 大样本数（1000符号）可能需要较大内存
3. **计算时间**: 完整仿真（包括BER曲线）可能需要几分钟
4. **MATLAB版本**: 建议使用MATLAB R2016b或更高版本

## 作者与版本

- **项目类型**: 毕业设计项目
- **开发环境**: MATLAB
- **最后更新**: 2024

## 许可证

本项目仅供学习和研究使用。

---

**提示**: 运行程序前请确保所有辅助函数文件（`qam16.m`, `demoduqam16.m`, `rcoswindow.m`）在同一目录下。

