### test8.m 使用说明（README）

`test8.m` 是一个功率谱密度（PSD）计算和采样过程仿真的 MATLAB 程序，包含：
- 单侧功率谱密度（PSD）计算示例（音频信号）
- 采样过程与时域表示仿真
- 带宽限制与混叠现象演示
- Welch 周期图算法 vs Periodogram 方法对比（如果实现）

---

### 环境要求
- MATLAB R2016a 或更高版本（建议更高版本）
- 无需额外依赖函数（使用 MATLAB 内置函数）

---

### 运行方法
1. 打开 MATLAB，将当前工作目录切换到本脚本所在路径。
2. 直接运行：
   ```matlab
   test8
   ```

---

### 主要功能

#### 1. 单侧功率谱密度（PSD）计算
- **参数设置**：
  - 采样率 Fs = 44.1 kHz（音频标准采样率）
  - 信号长度 N = 1024
  - 频率分辨率 Fres = Fs/N ≈ 43.07 Hz

- **信号生成**：
  - 多频率合成信号（440 Hz、880 Hz、1320 Hz、5000 Hz）
  - 模拟音频信号特性，包含少量噪声

- **PSD 计算公式**：
  - DC 分量 (k=0): `PSD(0) = (1/Fres) * |X(0)|^2`
  - 其他频率 (k=1 到 N/2): `PSD(k) = (1/(2*Fres)) * |X(k)|^2`

#### 2. 采样过程与时域表示仿真
- **采样过程**：
  - 展示连续时间信号 x(t)
  - 展示采样冲击函数序列 s(t) = Σ δ(t - n*Ts)
  - 展示采样后的信号 x_s(t) = x(t) * s(t)

- **频域分析**：
  - 连续信号的频谱（单边）
  - 采样后信号的频谱（周期延拓，每 Fs 重复）
  - 采样函数的频谱特性

#### 3. 带宽限制与混叠现象
- **奈奎斯特频率**：f_Nyquist = Fs/2
- **混叠演示**：展示超过奈奎斯特频率的信号如何发生混叠
- **频谱周期延拓**：展示采样后频谱的周期性特性

---

### 关键可调参数（在脚本顶部附近）
- **PSD 计算参数**：
  - `Fs = 44.1e3`：采样率（44.1 kHz）
  - `N = 1024`：信号长度
  - `Fres = Fs/N`：频率分辨率（自动计算）

- **测试信号参数**：
  - `f1 = 440`：440 Hz（A4音符）
  - `f2 = 880`：880 Hz（A5音符）
  - `f3 = 1320`：1320 Hz
  - `f4 = 5000`：5000 Hz

- **采样过程参数**：
  - `Fs_continuous = 10 * Fs`：连续信号的"采样率"（用于模拟连续信号）
  - `N_continuous = 10 * N`：连续信号的样本数

---

### 输出图形（主要）

#### 【一】单侧功率谱密度（PSD）分析
- **Figure 1**：矩形脉冲的傅里叶变换
  - 时域信号、理论/数值幅度谱、相位谱、对数幅度谱

- **Figure 2**：三角脉冲的傅里叶变换
  - 时域信号、理论/数值幅度谱、相位谱、对数幅度谱

- **Figure 3**：高斯脉冲的傅里叶变换
  - 时域信号、理论/数值幅度谱、相位谱、对数幅度谱

- **Figure 4**：三种信号的对比分析
  - 时域对比、频域幅度谱对比（线性和对数）

#### 【二】功率谱密度（PSD）计算示例
- **Figure 1-3**：时域信号、FFT幅度谱、单侧PSD（线性和对数刻度）
- **Figure 4**：三种信号的对比分析

#### 【三】采样过程与带宽限制
- **Figure 3**：采样过程可视化
  - 连续时间信号、采样冲击函数序列、采样后的信号
  - 连续信号频谱、采样后信号频谱、采样函数频谱

- **Figure 4**：带宽限制与混叠现象
  - 高频信号采样、混叠演示、频谱周期延拓、理想低通滤波器

---

### 关键概念解释

#### 1. 单侧功率谱密度（PSD）
- **DC 分量**：使用归一化因子 `1/Fres`
- **其他频率**：使用归一化因子 `1/(2*Fres)`（因为负频率功率已包含）
- **总功率**：PSD_total = PSD(0)*Fres + 2*Σ PSD(k)*Fres（k=1 到 N/2）

#### 2. 采样过程在时域的表示
- **采样函数**：s(t) = Σ δ(t - n*Ts)，其中 Ts = 1/Fs
- **采样过程**：x_s(t) = x(t) * s(t)
- **物理意义**：在离散时刻 t = n*Ts 对信号进行"冲击采样"

#### 3. 为什么信号带宽限制在采样率的一半
- **奈奎斯特频率**：f_Nyquist = Fs/2
- **混叠现象**：如果信号带宽 > Fs/2，高频分量会"折叠"到低频区域
- **采样定理**：要无失真地恢复信号，信号带宽必须 ≤ Fs/2

#### 4. 采样函数的频谱特性
- **周期性**：采样函数的频谱在频率轴上每 Fs Hz 重复一次
- **周期延拓**：采样后信号的频谱也是周期性的（周期 = Fs）
- **带宽限制**：为避免混叠，信号带宽必须限制在 Fs/2 以内

---

### 命令行输出

程序会输出以下信息：

1. **功率谱密度（PSD）计算仿真结果**：
   - 采样率、信号长度、频率分辨率
   - 主要频率分量的PSD值（DC、440 Hz、880 Hz等）

2. **功率守恒验证（帕塞瓦尔定理）**：
   - 时域功率 vs 频域功率
   - 相对误差

3. **单侧PSD计算公式说明**：
   - DC分量和其他频率的计算公式
   - 归一化因子说明

4. **采样过程与时域表示的解释**：
   - 采样过程的数学表示
   - 采样函数的频谱特性
   - 带宽限制的原因

5. **采样定理说明**：
   - 奈奎斯特频率
   - 混叠现象
   - 实际例子计算

---

### 常见问题（FAQ）

- **为什么DC分量使用不同的归一化因子？**
  - DC分量只出现一次，而其他频率分量在正负频率各出现一次（共轭对称）
  - 因此DC分量使用 `1/Fres`，其他频率使用 `1/(2*Fres)`

- **单侧PSD和双侧PSD有什么区别？**
  - 单侧PSD：只计算正频率部分（0 到 Fs/2），但已包含负频率的功率
  - 双侧PSD：计算正负频率部分（-Fs/2 到 Fs/2）
  - 单侧PSD的总功率 = 双侧PSD的总功率

- **为什么采样率在时域是冲击函数点？**
  - 采样过程可以表示为信号与冲击函数序列的乘积
  - 冲击函数序列在采样时刻有值，其他时刻为0
  - 这导致采样后的信号只在离散时刻有值

- **为什么信号带宽限制在采样率的一半？**
  - 采样后频谱会周期延拓，周期为 Fs
  - 如果信号带宽 > Fs/2，会发生混叠（高频折叠到低频）
  - 为避免混叠，信号带宽必须 ≤ Fs/2（奈奎斯特频率）

---

### 性能建议
- 如果需要更详细的频谱分析，可以增加信号长度 N
- 如果需要观察更高频率的混叠现象，可以调整 f_alias 参数
- 如果需要更平滑的功率谱估计，可以使用 Welch 方法（如果实现）

---

### 文件清单（与本脚本相关）
- `test8.m`：主仿真脚本（本文件说明对应）

---

如需进一步说明或扩展（如 Welch 方法实现、其他窗函数、多速率采样），可在现有流程基础上添加相应模块。祝你仿真顺利！


