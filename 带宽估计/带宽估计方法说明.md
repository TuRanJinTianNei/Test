# 带宽估计方法说明

本文档介绍了几种常用的功率谱密度（PSD）带宽估计方法，适用于OFDM等信号的带宽估计。

## 方法概览

### 1. **阈值法 (Threshold Method)**

- **原理**: 在PSD峰值两侧找到指定阈值（如-3dB）对应的频率点
- **优点**:
  - 简单直观，计算快速
  - 适用于有明显主瓣的信号
- **缺点**:
  - 阈值选择需要经验
  - 对噪声敏感
- **适用场景**: SNR较高、信号形状规则的场景
- **参数**: `threshold_db` (默认: -3 dB)

### 2. **差分内插法 (Difference Interpolation Method)**

- **原理**:
  - 计算PSD的一阶差分，找到变化最大的位置
  - 通过线性内插得到精确的边界点
- **优点**:
  - 能准确定位信号边缘
  - 对边缘变化敏感
- **缺点**:
  - 计算复杂度较高
  - 需要足够的采样点
- **适用场景**: 需要高精度边界估计的场景
- **参数**: 无

### 3. **能量百分比法 (Energy Percent Method)**

- **原理**: 找到包含指定百分比（如90%）信号能量的频率范围
- **优点**:
  - 物理意义明确
  - 对噪声相对鲁棒
- **缺点**:
  - 计算较慢（需要积分）
  - 百分比选择需要经验
- **适用场景**: 关注信号能量分布的场景
- **参数**: `energy_percent` (默认: 90%)

### 4. **峰值下降法 (Peak Drop Method)**

- **原理**: 从PSD峰值下降指定dB值，找到对应的频率点
- **优点**:
  - 简单易用
  - 与阈值法类似但更直观
- **缺点**:
  - 需要知道峰值位置
  - 对多峰值信号效果差
- **适用场景**: 单峰值、SNR较高的信号
- **参数**: `peak_drop_db` (默认: -3 dB)

### 5. **RMS带宽法 (RMS Bandwidth Method)**

- **原理**: 基于功率谱的二阶矩（方差）计算RMS带宽
- **优点**:
  - 统计意义明确
  - 对噪声有一定鲁棒性
- **缺点**:
  - 可能不准确反映实际带宽
  - 对PSD形状敏感
- **适用场景**: 需要统计特性的场景
- **参数**: 无

### 6. **自适应阈值法 (Adaptive Threshold Method)**

- **原理**: 根据PSD的动态范围自动调整阈值
- **优点**:
  - 适应不同SNR条件
  - 无需手动调整阈值
- **缺点**:
  - 需要估计噪声底
  - 参数选择影响结果
- **适用场景**: SNR变化较大的场景
- **参数**: `adaptive_factor` (默认: 0.1)

### 7. **梯度边缘检测法 (Gradient Edge Detection Method)**

- **原理**: 通过PSD的梯度（一阶差分）找到信号边缘
- **优点**:
  - 能准确检测边缘
  - 计算简单
- **缺点**:
  - 对噪声敏感
  - 可能受局部波动影响
- **适用场景**: 边缘明显的信号
- **参数**: 无

## 方法选择建议

### 根据SNR选择：

- **高SNR (>10 dB)**: 阈值法、峰值下降法、差分内插法
- **中等SNR (5-10 dB)**: 能量百分比法、自适应阈值法
- **低SNR (<5 dB)**: 能量百分比法、RMS带宽法

### 根据信号特性选择：

- **单峰值信号**: 峰值下降法、阈值法
- **多峰值信号**: 能量百分比法、RMS带宽法
- **边缘明显**: 梯度边缘检测法、差分内插法
- **边缘平滑**: 能量百分比法、自适应阈值法

### 根据精度要求选择：

- **高精度**: 差分内插法、梯度边缘检测法
- **中等精度**: 阈值法、峰值下降法
- **统计特性**: RMS带宽法、能量百分比法

## 使用示例

```matlab
% 基本用法
[bl, bu, B, details] = estimateBandwidthMethods(Pxx, f, 'threshold', 'threshold_db', -3);

% 能量百分比法
[bl, bu, B, details] = estimateBandwidthMethods(Pxx, f, 'energy_percent', 'energy_percent', 90);

% 自适应阈值法
[bl, bu, B, details] = estimateBandwidthMethods(Pxx, f, 'adaptive', 'adaptive_factor', 0.1);
```

## 对比测试

运行 `test_bandwidth_methods_comparison.m` 可以对比所有方法的效果，包括：

- 带宽估计值对比
- 相对误差对比
- 可视化边界位置

## 注意事项

1. **PSD归一化**: 确保PSD已正确归一化（峰值在0dB）
2. **频率范围**: 确保频率向量覆盖信号带宽
3. **采样点数**: 足够的采样点能提高估计精度
4. **参数调整**: 根据实际信号特性调整方法参数
5. **方法组合**: 可以结合多种方法的结果提高鲁棒性

## 参考文献

- 阈值法: 经典的-3dB带宽定义
- 能量百分比法: 基于信号能量分布
- RMS带宽法: 基于统计矩理论
- 其他方法: 基于信号处理理论
